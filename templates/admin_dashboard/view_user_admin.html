
{% load static %}


{% block content %}
<link rel="stylesheet" href="{% static 'style.css' %}">
<link rel="stylesheet" href="{% static 'admin_dashboard/admin_dashboard.css' %}">

<div class="container">
    <!-- Sidebar -->
    {% include 'admin_dashboard/sidebar.html' %}


    <main class="main-content1" id="mainContent1">
        
        <div class="top-bar1">
            <!-- Back Button -->
         
                <a href="{% url 'admin_dashboard' %}#users" class="btn btn-secondary">
                    ‚Üê Back to Dashboard
                </a>
     
        </div>

        <!-- User Profile Card -->
        <div class="dashboard-card1">
            <div class="card-header1">
                <h2 class="card-title1">üë§ User Profile</h2>
                <div style="display: flex; gap: 1rem;">
                    <a href="{% url 'admin_edit_user' view_user.slug %}" class="btn1 btn-primary1" style="text-decoration: none;">
                        ‚úèÔ∏è Edit User
                    </a>
                    <button onclick="if(confirm('Are you sure you want to delete this user?')) window.location.href='{% url 'admin_delete_user' view_user.slug %}'" 
                            class="btn1" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
                        üóëÔ∏è Delete User
                    </button>
                </div>
            </div>

            <div class="info-grid">
                <!-- Profile Picture -->
                <div class="info-item" style="grid-column: 1 / -1; text-align: center;">
                    <div class="profile-photo" style="width: 120px; height: 120px; margin: 1rem auto;">
                        {% if view_user.profile_picture %}
                            <img src="{{ view_user.profile_picture.url }}" alt="{{ view_user.get_full_name }}">
                        {% else %}
                            {{ view_user.first_name|first|upper }}{{ view_user.last_name|first|upper }}
                        {% endif %}
                    </div>
                    <h2 style="color: white; margin-top: 1rem;">{{ view_user.get_full_name }}</h2>
                    <p style="color: rgba(255,255,255,0.7);">{{ view_user.email }}</p>
                </div>

                <!-- Personal Information -->
                <div class="info-item">
                    <div class="info-label">Student ID</div>
                    <div class="info-value">{{ view_user.student_id|default:"Not provided" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Gender</div>
                    <div class="info-value">{{ view_user.get_gender_display|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Phone</div>
                    <div class="info-value">{{ view_user.phone|default:"Not provided" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Date of Birth</div>
                    <div class="info-value">{{ view_user.date_of_birth|date:"F d, Y"|default:"Not provided" }}</div>
                </div>

                <!-- Academic Information -->
                <div class="info-item">
                    <div class="info-label">University</div>
                    <div class="info-value">{{ view_user.university.title|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Department</div>
                    <div class="info-value">{{ view_user.department.title|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Batch</div>
                    <div class="info-value">{{ view_user.batch|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Dept Batch</div>
                    <div class="info-value">{{ view_user.dept_batch|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Section</div>
                    <div class="info-value">{{ view_user.section|default:"Not specified" }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">Role</div>
                    <div class="info-value">{{ view_user.role|title }}</div>
                </div>

                <!-- Account Status -->
                <div class="info-item">
                    <div class="info-label">Account Status</div>
                    <div class="info-value">
                        {% if view_user.is_active %}
                            <span class="badge1 approved">‚úì Active</span>
                        {% else %}
                            <span class="badge1 rejected">‚úó Inactive</span>
                        {% endif %}
                    </div>
                </div>

                <div class="info-item">
                    <div class="info-label">Email Verified</div>
                    <div class="info-value">
                        {% if view_user.is_email_verified %}
                            <span class="badge1 approved">‚úì Verified</span>
                        {% else %}
                            <span class="badge1 pending">‚è≥ Pending</span>
                        {% endif %}
                    </div>
                </div>

                <div class="info-item">
                    <div class="info-label">Staff Member</div>
                    <div class="info-value">
                        {% if view_user.is_staff %}
                            <span class="badge1 approved">‚úì Yes</span>
                        {% else %}
                            <span class="badge1">No</span>
                        {% endif %}
                    </div>
                </div>

                <div class="info-item">
                    <div class="info-label">Joined Date</div>
                    <div class="info-value">{{ view_user.created_at|date:"F d, Y" }}</div>
                </div>

                <!-- Bio -->
                {% if view_user.bio %}
                <div class="info-item" style="grid-column: 1 / -1;">
                    <div class="info-label">Bio</div>
                    <div class="info-value">{{ view_user.bio }}</div>
                </div>
                {% endif %}

                <!-- Social Links -->
                <div class="info-item" style="grid-column: 1 / -1;">
                    <div class="info-label">Social Links</div>
                    <div class="social-links" style="margin-top: 1rem;">
                        {% if view_user.facebook_url != 'https://www.facebook.com/' %}
                            <a href="{{ view_user.facebook_url }}" target="_blank" class="social-btn">üìò</a>
                        {% endif %}
                        {% if view_user.instagram_url != 'https://www.instagram.com/' %}
                            <a href="{{ view_user.instagram_url }}" target="_blank" class="social-btn">üì∑</a>
                        {% endif %}
                        {% if view_user.linkedin_url != 'https://www.linkedin.com/' %}
                            <a href="{{ view_user.linkedin_url }}" target="_blank" class="social-btn">üíº</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats" style="margin: 2rem 0;">
            <div class="stat-card">
                <div class="stat-icon">üìù</div>
                <div class="stat-number">{{ total_reviews_count }}</div>
                <div class="stat-label">Total Reviews</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-number">{{ approved_reviews_count }}</div>
                <div class="stat-label">Approved Reviews</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-number">{{ pending_reviews_count }}</div>
                <div class="stat-label">Pending Reviews</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üíæ</div>
                <div class="stat-number">{{ saved_crs_count }}</div>
                <div class="stat-label">Saved CRs</div>
            </div>
        </div>

        <!-- Recent Reviews -->
        {% if reviews %}
        <div class="dashboard-card1">
            <div class="card-header1">
                <h2 class="card-title1">üìù Recent Reviews</h2>
            </div>
            {% for review in reviews %}
            <div class="review-card">
                <div class="review-header">
                    <div>
                        <strong>{{ review.cr_profile.name }}</strong>
                        <div class="rating">
                            {% for i in "12345" %}
                                <span class="star {% if forloop.counter <= review.rating %}filled{% endif %}">‚òÖ</span>
                            {% endfor %}
                        </div>
                    </div>
                    <div style="color: rgba(255,255,255,0.7);">
                        {{ review.created_at|date:"M d, Y" }}
                    </div>
                </div>
                <div class="review-text">
                    "{{ review.description|truncatewords:30 }}"
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Saved CRs -->
        {% if saved_crs %}
        <div class="dashboard-card1">
            <div class="card-header1">
                <h2 class="card-title1">üíæ Saved CRs</h2>
            </div>
            <div class="grid">
                {% for saved in saved_crs %}
                <div class="card">
                    <div class="profile-photo">
                        {% if saved.cr_profile.profile_picture %}
                            <img src="{{ saved.cr_profile.profile_picture.url }}" alt="{{ saved.cr_profile.name }}">
                        {% else %}
                            {{ saved.cr_profile.name|first|upper }}
                        {% endif %}
                    </div>
                    <div class="cr-name">{{ saved.cr_profile.name }}</div>
                    <div class="cr-details">
                        {{ saved.cr_profile.university.title }}<br>
                        {{ saved.cr_profile.department.title }}
                    </div>
                    <div class="rating">
                        {% for i in "12345" %}
                            <span class="star {% if forloop.counter <= saved.cr_profile.average_rating %}filled{% endif %}">‚òÖ</span>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

            
    </main>

   
</div>
<script src="{% static 'admin_dashboard/admin_dashboard.js' %}"></script>
<script src="{% static 'script.js' %}"></script>
{% endblock %}